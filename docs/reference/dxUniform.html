<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Code format transformation — dxUniform • dxpr</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Code format transformation — dxUniform"><meta property="og:description" content="These two functions can convert the ICD diagnostic codes to a uniform format."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">dxpr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.9.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/DHLab-TSENG/dxpr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Code format transformation</h1>
    <small class="dont-index">Source: <a href="https://github.com/DHLab-TSENG/dxpr/blob/HEAD/R/fun_emr.R" class="external-link"><code>R/fun_emr.R</code></a>, <a href="https://github.com/DHLab-TSENG/dxpr/blob/HEAD/R/icdDxDecimalToShort.R" class="external-link"><code>R/icdDxDecimalToShort.R</code></a>, <a href="https://github.com/DHLab-TSENG/dxpr/blob/HEAD/R/icdDxShortToDecimal.R" class="external-link"><code>R/icdDxShortToDecimal.R</code></a></small>
    <div class="hidden name"><code>dxUniform.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>These two functions can convert the ICD diagnostic codes to a uniform format.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">icdDxDecimalToShort</span><span class="op">(</span>
  <span class="va">dxDataFile</span>,
  <span class="va">icdColName</span>,
  <span class="va">dateColName</span>,
  icdVerColName <span class="op">=</span> <span class="cn">NULL</span>,
  icd10usingDate <span class="op">=</span> <span class="cn">NULL</span>
<span class="op">)</span>

<span class="fu">icdDxShortToDecimal</span><span class="op">(</span>
  <span class="va">dxDataFile</span>,
  <span class="va">icdColName</span>,
  <span class="va">dateColName</span>,
  icdVerColName <span class="op">=</span> <span class="cn">NULL</span>,
  icd10usingDate <span class="op">=</span> <span class="cn">NULL</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>dxDataFile</dt>
<dd><p>A data frame object of clinical diagnostic data with at least 2 columns: ICD, and Date. As for date column, the data format should be YYYY/MM/DD or YYYY-MM-DD.</p></dd>
<dt>icdColName</dt>
<dd><p>Column name of ICD column in dxDataFile. Data type of this argumant should be string without quotation marks.</p></dd>
<dt>dateColName</dt>
<dd><p>Column name of date column in dxDataFile, and the type of date column should be a date format in R or a string format with date information in YYYY/MM/DD or YYYY-MM-DD. Data type of this argumant should be string without quotation marks.</p></dd>
<dt>icdVerColName</dt>
<dd><p>(Optional) Column name if there is a columns to record ICD-9/10 version used in dxDataFile. In this column, data format should be numeric 9L or 10L to indicate which ICD version is used for each cell. See examples below to get more information.</p></dd>
<dt>icd10usingDate</dt>
<dd><p>The date that ICD-10 was started to be used in dxDataFile dataset. The data format should be YYYY/MM/DD or YYYY-MM-DD. Necessary if icdVerColName is null.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>Two new <code>data.table</code>s. 1) <code>ICD</code>: Uniform format diagnostic codes with column name "ICD". 2) <code>Error</code>: Potential error codes with 5 columns: ICD, count, IcdVersionInFile, WrongType and Suggestion.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p><code>icdDxShortToDecimal</code> can be used for grouping diagnostic code to PheWAS classification (<code><a href="dxPheWAS.html">dxPheWAS</a></code>: icdDxToPheWAS). <code>icdDxDecimalToShort</code> can be used for grouping to the other classification methods (<code><a href="dxCCS.html">dxCCS</a></code>: icdDxToCCS &amp; icdDxToCCSLvl; <code><a href="dxComorbid.html">dxComorbid</a></code>: icdDxToComorbid). These transformation functions do not only convert the ICD codes to uniform format but also check potential coding error of the ICD format and version.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="co"># sample file for example</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">sampleDxFile</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     ID  ICD       Date Version</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1:  A2 Z992 2020-05-22      10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2:  A5 Z992 2020-01-24      10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3:  A8 Z992 2015-10-27      10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4: A13 Z992 2020-04-26      10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5: A13 Z992 2025-02-02      10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6: A15 Z992 2023-05-12      10</span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># convert the diagnostic codes to the decimal format</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu">icdDxShortToDecimal</span><span class="op">(</span><span class="va">sampleDxFile</span>,<span class="va">ICD</span>,<span class="va">Date</span>, icd10usingDate <span class="op">=</span> <span class="st">"2015/10/01"</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Wrong ICD format: total 9 ICD codes (the number of occurrences is in brackets)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> c("A0.11 (20)", "E114 (8)", "Z9.90 (6)", "F42 (6)", "001 (5)", "75.52 (4)", "755.2 (3)", "123.45 (3)", "7552 (2)")</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 	</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Wrong ICD version: total 7 ICD codes (the number of occurrences is in brackets)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> c("V27.0 (18)", "A01.05 (8)", "42761 (7)", "V24.1 (6)", "A0105 (5)", "E03.0 (4)", "650 (4)")</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 	</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>The ICD mentioned above matches to "NA" due to the format or other issues.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>"Wrong ICD format" means the ICD has wrong format</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>"Wrong ICD version" means the ICD classify to wrong ICD version (cause the "icd10usingDate" or other issues)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ICD</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         ICD</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1:  Z99.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2:  Z99.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   3:  Z99.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   4:  Z99.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   5:  Z99.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ---       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 296:    650</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 297:    650</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 298: 123.45</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 299: 123.45</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 300: 123.45</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        ICD count IcdVersionInFile     WrongType Suggestion</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1:  A0.11    20           ICD 10  Wrong format           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2:  V27.0    18           ICD 10 Wrong version           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3:   E114     8           ICD 10  Wrong format           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4: A01.05     8            ICD 9 Wrong version           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  5:  42761     7           ICD 10 Wrong version           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  6:  Z9.90     6           ICD 10  Wrong format           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  7:    F42     6           ICD 10  Wrong format           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  8:  V24.1     6           ICD 10 Wrong version           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  9:  A0105     5            ICD 9 Wrong version           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10:    001     5            ICD 9  Wrong format       0019</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11:  75.52     4            ICD 9  Wrong format           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12:  E03.0     4            ICD 9 Wrong version           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13:    650     4           ICD 10 Wrong version           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14: 123.45     3           ICD 10  Wrong format           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15:  755.2     3            ICD 9  Wrong format     755.29</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16:   7552     2            ICD 9  Wrong format      75529</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># convert the diagnostic codes to the short format</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu">icdDxDecimalToShort</span><span class="op">(</span><span class="va">sampleDxFile</span>,<span class="va">ICD</span>,<span class="va">Date</span>, icd10usingDate <span class="op">=</span> <span class="st">"2015/10/01"</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Wrong ICD format: total 9 ICD codes (the number of occurrences is in brackets)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> c("A0.11 (20)", "E114 (8)", "Z9.90 (6)", "F42 (6)", "001 (5)", "75.52 (4)", "755.2 (3)", "123.45 (3)", "7552 (2)")</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 	</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Wrong ICD version: total 7 ICD codes (the number of occurrences is in brackets)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> c("V27.0 (18)", "A01.05 (8)", "42761 (7)", "V24.1 (6)", "A0105 (5)", "E03.0 (4)", "650 (4)")</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 	</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>The ICD mentioned above matches to "NA" due to the format or other issues.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>"Wrong ICD format" means the ICD has wrong format</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>"Wrong ICD version" means the ICD classify to wrong ICD version (cause the "icd10usingDate" or other issues)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ICD</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         ICD</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1:   Z992</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2:   Z992</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   3:   Z992</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   4:   Z992</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   5:   Z992</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ---       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 296:    650</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 297:    650</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 298: 123.45</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 299: 123.45</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 300: 123.45</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        ICD count IcdVersionInFile     WrongType Suggestion</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1:  A0.11    20           ICD 10  Wrong format           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2:  V27.0    18           ICD 10 Wrong version           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3:   E114     8           ICD 10  Wrong format           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4: A01.05     8            ICD 9 Wrong version           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  5:  42761     7           ICD 10 Wrong version           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  6:  Z9.90     6           ICD 10  Wrong format           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  7:    F42     6           ICD 10  Wrong format           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  8:  V24.1     6           ICD 10 Wrong version           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  9:  A0105     5            ICD 9 Wrong version           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10:    001     5            ICD 9  Wrong format       0019</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11:  75.52     4            ICD 9  Wrong format           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12:  E03.0     4            ICD 9 Wrong version           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13:    650     4           ICD 10 Wrong version           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14: 123.45     3           ICD 10  Wrong format           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15:  755.2     3            ICD 9  Wrong format     755.29</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16:   7552     2            ICD 9  Wrong format      75529</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Yi-Ju Tseng, Hsiang-Ju Chiu, Chun-Ju Chen.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

      </footer></div>

  


  

  </body></html>

